<html lang="en">
  <head>
    <title>XHR</title>
  </head>
  <body>
    <button id="syncBtn">同步</button>
    <button id="asyncBtn">非同步</button>
    <button id="countBtn">測試按鈕</button>
    <div id="count">0</div>
    <div id="response">準備要顯示訊息</div>

    <script>
      // testing url: http://35.78.120.240:3000/sleepy
      var response = document.getElementById("response");

      //同步
      var syncBtn = document.getElementById("syncBtn");
      // add click event
      syncBtn.addEventListener("click", function () {
        response.innerHTML = "開始同步請求了！";
        var xhr = new XMLHttpRequest();
        // 設定當請求有回覆的要做什麼事
        xhr.onload = function () {
          if (this.status === 200) {
            response.innerHTML = `同步請求的 response ${this.responseText}`;
          } else {
            response.innerHTML = `同步請求失敗: ${this.status}`;
          }
        };
        // method (get, post, delete, put...), url, async (defalut: true 是非同步)
        xhr.open("GET", "http://35.78.120.240:3000/sleepy", false);
        xhr.send();
      });

      // 非同步
      var asyncBtn = document.getElementById("asyncBtn");
      // add click event
      asyncBtn.addEventListener("click", function () {
        response.innerHTML = "開始非同步請求了！";
        var xhr = new XMLHttpRequest();
        // 設定當請求有回覆的要做什麼事
        xhr.onload = function () {
          if (this.status === 200) {
            response.innerHTML = `非同步請求的 response ${this.responseText}`;
          } else {
            response.innerHTML = `非同步請求失敗: ${this.status}`;
          }
        };
        // method (get, post, delete, put...), url, async (defalut: true 是非同步)
        xhr.open("GET", "http://35.78.120.240:3000/sleepy", true);
        xhr.send();
      });

      // 測試按鈕
      var countBtn = document.getElementById("countBtn");
      var count = document.getElementById("count");
      // add count event
      countBtn.addEventListener("click", function () {
        count.innerHTML = parseInt(count.innerHTML, 10) + 1;
      });
    </script>
  </body>
</html>
